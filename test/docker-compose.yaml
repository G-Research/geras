faketsdb:
  image: golang:1-alpine
  ports:
    - 4242:4242
  volumes:
    - ./:/app
  environment:
    - GO111MODULE=on
  command: ["go", "run", "/app/faketsdb.go"]

geras:
  #build: ..
  image: g-research/geras:$CIRCLE_BRANCH
  ports:
    - 19000:19000
    - 19001:19001
  links:
    - faketsdb
  command:
    - "-log.level=debug"
    - "-opentsdb-address=faketsdb:4242"
    - "-trace-dumpbody"
    - "-grpc-listen=:19000"
    - "-http-listen=:19001"

thanos:
  image: thanosio/thanos:v0.8.1
  ports:
    - 10902:10902
  links:
    - geras
  command: ["query", "--store=geras:19000"]
